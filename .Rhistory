#            method= "pearson", geom = "label", size = 2.5, alpha = 0.5,
#            # position = position_dodge2(width = 0.5),
#            label.x.npc = "left", label.y.npc = "top",
#            p.accuracy = 0.001, r.accuracy = 0.01) +
# coord_trans(x = 'log10') +
scale_x_log10() +
scale_y_continuous(expand = expansion(mult = c(0, 0.5))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = bquote("Watershed Area ("*km^2*")"), y = "Dependent Variables")
##4.1 Dependent vars vs Watershed Area----
dat4 %>% ggplot() +
geom_jitter(mapping= aes(x= WsAreaSqKm, y= dep_values), width = 0.02) +
geom_smooth(mapping= aes(x= WsAreaSqKm, y= dep_values),
method = "lm", se=TRUE) +
stat_correlation(mapping= aes(x= WsAreaSqKm, y= dep_values),
use_label(c("r", "p")),
# use_label("p.value"),
# small.r = TRUE, small.p = TRUE,
r.digits = 2, p.digits = 3,
label.x = 0, label.y = 1,
inherit.aes = FALSE) +
# ,
#                         label = paste(..rr.label.., ..p.label.., sep = "~`,`~")),
#            inherit.aes = FALSE,
#            method= "pearson", geom = "label", size = 2.5, alpha = 0.5,
#            # position = position_dodge2(width = 0.5),
#            label.x.npc = "left", label.y.npc = "top",
#            p.accuracy = 0.001, r.accuracy = 0.01) +
# coord_trans(x = 'log10') +
scale_x_log10() +
scale_y_continuous(expand = expansion(mult = c(0, 0.5))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = bquote("Watershed Area ("*km^2*")"), y = "Dependent Variables")
##4.1 Dependent vars vs Watershed Area----
dat4 %>% ggplot() +
geom_jitter(mapping= aes(x= WsAreaSqKm, y= dep_values), width = 0.02) +
geom_smooth(mapping= aes(x= WsAreaSqKm, y= dep_values),
method = "lm", se=TRUE) +
stat_correlation(mapping= aes(x= WsAreaSqKm, y= dep_values),
use_label(c("r", "p")),
# use_label("p.value"),
# small.r = TRUE, small.p = TRUE,
r.digits = 2, p.digits = 3,
label.x = 0, label.y = 1,
inherit.aes = FALSE) +
# ,
#                         label = paste(..rr.label.., ..p.label.., sep = "~`,`~")),
#            inherit.aes = FALSE,
#            method= "pearson", geom = "label", size = 2.5, alpha = 0.5,
#            # position = position_dodge2(width = 0.5),
#            label.x.npc = "left", label.y.npc = "top",
#            p.accuracy = 0.001, r.accuracy = 0.01) +
# coord_trans(x = 'log10') +
scale_x_log10() +
# scale_y_continuous(expand = expansion(mult = c(0, 0.5))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = bquote("Watershed Area ("*km^2*")"), y = "Dependent Variables")
##4.1 Dependent vars vs Watershed Area----
dat4 %>% ggplot() +
geom_jitter(mapping= aes(x= WsAreaSqKm, y= dep_values), width = 0.02) +
geom_smooth(mapping= aes(x= WsAreaSqKm, y= dep_values),
method = "lm", se=TRUE) +
stat_correlation(mapping= aes(x= WsAreaSqKm, y= dep_values,
use_label(c("r", "p"))),
# use_label("p.value"),
# small.r = TRUE, small.p = TRUE,
r.digits = 2, p.digits = 3,
label.x = 0, label.y = 1,
inherit.aes = FALSE) +
# ,
#                         label = paste(..rr.label.., ..p.label.., sep = "~`,`~")),
#            inherit.aes = FALSE,
#            method= "pearson", geom = "label", size = 2.5, alpha = 0.5,
#            # position = position_dodge2(width = 0.5),
#            label.x.npc = "left", label.y.npc = "top",
#            p.accuracy = 0.001, r.accuracy = 0.01) +
# coord_trans(x = 'log10') +
scale_x_log10() +
# scale_y_continuous(expand = expansion(mult = c(0, 0.5))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = bquote("Watershed Area ("*km^2*")"), y = "Dependent Variables")
##4.1 Dependent vars vs Watershed Area----
dat4 %>% ggplot() +
geom_jitter(mapping= aes(x= WsAreaSqKm, y= dep_values), width = 0.02) +
geom_smooth(mapping= aes(x= WsAreaSqKm, y= dep_values),
method = "lm", se=TRUE) +
stat_correlation(use_label(c("r", "p"))) +
# stat_correlation(mapping= aes(x= WsAreaSqKm, y= dep_values,
#                  use_label(c("r", "p"))),
#                  # use_label("p.value"),
#                  # small.r = TRUE, small.p = TRUE,
#                  r.digits = 2, p.digits = 3,
#                  label.x = 0, label.y = 1,
#                  inherit.aes = FALSE) +
# ,
#                         label = paste(..rr.label.., ..p.label.., sep = "~`,`~")),
#            inherit.aes = FALSE,
#            method= "pearson", geom = "label", size = 2.5, alpha = 0.5,
#            # position = position_dodge2(width = 0.5),
#            label.x.npc = "left", label.y.npc = "top",
#            p.accuracy = 0.001, r.accuracy = 0.01) +
# coord_trans(x = 'log10') +
scale_x_log10() +
# scale_y_continuous(expand = expansion(mult = c(0, 0.5))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = bquote("Watershed Area ("*km^2*")"), y = "Dependent Variables")
##4.1 Dependent vars vs Watershed Area----
dat4 %>% ggplot(mapping= aes(x= WsAreaSqKm, y= dep_values)) +
geom_jitter(width = 0.02) +
geom_smooth(method = "lm", se=TRUE) +
stat_correlation(use_label(c("r", "p"))) +
# stat_correlation(mapping= aes(x= WsAreaSqKm, y= dep_values,
#                  use_label(c("r", "p"))),
#                  # use_label("p.value"),
#                  # small.r = TRUE, small.p = TRUE,
#                  r.digits = 2, p.digits = 3,
#                  label.x = 0, label.y = 1,
#                  inherit.aes = FALSE) +
# ,
#                         label = paste(..rr.label.., ..p.label.., sep = "~`,`~")),
#            inherit.aes = FALSE,
#            method= "pearson", geom = "label", size = 2.5, alpha = 0.5,
#            # position = position_dodge2(width = 0.5),
#            label.x.npc = "left", label.y.npc = "top",
#            p.accuracy = 0.001, r.accuracy = 0.01) +
# coord_trans(x = 'log10') +
scale_x_log10() +
# scale_y_continuous(expand = expansion(mult = c(0, 0.5))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = bquote("Watershed Area ("*km^2*")"), y = "Dependent Variables")
##4.1 Dependent vars vs Watershed Area----
dat4 %>% ggplot(mapping= aes(x= WsAreaSqKm, y= dep_values)) +
geom_jitter(width = 0.02) +
geom_smooth(method = "lm", se=TRUE) +
stat_correlation(use_label(c("r", "p")),
small.r = TRUE, small.p = TRUE,
r.digits = 2, p.digits = 3,
label.x = 0, label.y = 1,
inherit.aes = FALSE) +
# ,
#                         label = paste(..rr.label.., ..p.label.., sep = "~`,`~")),
#            inherit.aes = FALSE,
#            method= "pearson", geom = "label", size = 2.5, alpha = 0.5,
#            # position = position_dodge2(width = 0.5),
#            label.x.npc = "left", label.y.npc = "top",
#            p.accuracy = 0.001, r.accuracy = 0.01) +
# coord_trans(x = 'log10') +
scale_x_log10() +
# scale_y_continuous(expand = expansion(mult = c(0, 0.5))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = bquote("Watershed Area ("*km^2*")"), y = "Dependent Variables")
##4.1 Dependent vars vs Watershed Area----
dat4 %>% ggplot(mapping= aes(x= WsAreaSqKm, y= dep_values)) +
geom_jitter(width = 0.02) +
geom_smooth(method = "lm", se=TRUE) +
stat_correlation(use_label(c("r", "p")),
small.r = TRUE, small.p = TRUE) +
# r.digits = 2, p.digits = 3,
# label.x = 0, label.y = 1,
# inherit.aes = FALSE) +
# ,
#                         label = paste(..rr.label.., ..p.label.., sep = "~`,`~")),
#            inherit.aes = FALSE,
#            method= "pearson", geom = "label", size = 2.5, alpha = 0.5,
#            # position = position_dodge2(width = 0.5),
#            label.x.npc = "left", label.y.npc = "top",
#            p.accuracy = 0.001, r.accuracy = 0.01) +
# coord_trans(x = 'log10') +
scale_x_log10() +
# scale_y_continuous(expand = expansion(mult = c(0, 0.5))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = bquote("Watershed Area ("*km^2*")"), y = "Dependent Variables")
##4.1 Dependent vars vs Watershed Area----
dat4 %>% ggplot(mapping= aes(x= WsAreaSqKm, y= dep_values)) +
geom_jitter(width = 0.02) +
geom_smooth(method = "lm", se=TRUE) +
stat_correlation(use_label(c("r", "p")),
small.r = TRUE, small.p = TRUE) +
# r.digits = 2, p.digits = 3,
# label.x = 0, label.y = 1,
# inherit.aes = FALSE) +
# ,
#                         label = paste(..rr.label.., ..p.label.., sep = "~`,`~")),
#            inherit.aes = FALSE,
#            method= "pearson", geom = "label", size = 2.5, alpha = 0.5,
#            # position = position_dodge2(width = 0.5),
#            label.x.npc = "left", label.y.npc = "top",
#            p.accuracy = 0.001, r.accuracy = 0.01) +
# coord_trans(x = 'log10') +
scale_x_log10() +
scale_y_continuous(expand = expansion(mult = c(0, 0.5))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = bquote("Watershed Area ("*km^2*")"), y = "Dependent Variables")
ggsave(paste0(here, "/figs/f1_DepVarsVsWsArea_ByWatershed.png"),
width = 11, height = 8)
##4.1 Dependent vars vs Watershed Area----
dat4 %>% ggplot(mapping= aes(x= WsAreaSqKm, y= dep_values)) +
geom_jitter(width = 0.02) +
geom_smooth(method = "lm", se=TRUE) +
stat_correlation(use_label(c("r", "p")),
small.r = TRUE, small.p = TRUE) +
scale_x_log10() +
scale_y_continuous(expand = expansion(mult = c(0, 0.1))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = bquote("Watershed Area ("*km^2*")"), y = "Dependent Variables")
ggsave(paste0(here, "/figs/f1_DepVarsVsWsArea_ByWatershed.png"),
width = 11, height = 8)
##4.1 Dependent vars vs Watershed Area----
dat4 %>% ggplot(mapping= aes(x= WsAreaSqKm, y= dep_values)) +
geom_jitter(width = 0.02) +
geom_smooth(method = "lm", se=TRUE) +
stat_correlation(use_label(c("r", "p")),
small.r = TRUE, small.p = TRUE) +
scale_x_log10() +
scale_y_continuous(expand = expansion(mult = c(0, 0.2))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = bquote("Watershed Area ("*km^2*")"), y = "Dependent Variables")
ggsave(paste0(here, "/figs/f1_DepVarsVsWsArea_ByWatershed.png"),
width = 11, height = 8)
##4.1 Dependent vars vs Watershed Area----
dat4 %>% ggplot(mapping= aes(x= WsAreaSqKm, y= dep_values)) +
geom_jitter(width = 0.02) +
geom_smooth(method = "lm", se=TRUE) +
stat_correlation(use_label(c("rr", "p")),
small.r = TRUE, small.p = TRUE) +
scale_x_log10() +
scale_y_continuous(expand = expansion(mult = c(0, 0.2))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = bquote("Watershed Area ("*km^2*")"), y = "Dependent Variables")
##4.1 Dependent vars vs Watershed Area----
dat4 %>% ggplot(mapping= aes(x= WsAreaSqKm, y= dep_values)) +
geom_jitter(width = 0.02) +
geom_smooth(method = "lm", se=TRUE) +
scale_x_log10() +
scale_y_continuous(expand = expansion(mult = c(0, 0.2))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = bquote("Watershed Area ("*km^2*")"), y = "Dependent Variables") +
stat_correlation(use_label(c("rr", "p")),
small.r = TRUE, small.p = TRUE) +
ggsave(paste0(here, "/figs/f1_DepVarsVsWsArea_ByWatershed.png"),
width = 11, height = 8)
##4.1 Dependent vars vs Watershed Area----
dat4 %>% ggplot(mapping= aes(x= WsAreaSqKm, y= dep_values)) +
geom_jitter(width = 0.02) +
geom_smooth(method = "lm", se=TRUE) +
scale_x_log10() +
scale_y_continuous(expand = expansion(mult = c(0, 0.2))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = bquote("Watershed Area ("*km^2*")"), y = "Dependent Variables") +
stat_correlation(use_label(c("rr", "p")),
small.r = TRUE, small.p = TRUE)
ggsave(paste0(here, "/figs/f1_DepVarsVsWsArea_ByWatershed.png"),
width = 11, height = 8)
dat3 %>% ggplot(mapping= aes(x= expl_values, y= dep_values)) +
geom_jitter(width = 0.02) +
geom_smooth(method = "lm", se=TRUE) +
scale_x_log10() +
facet_grid(rows = vars(dep_names), cols = vars(expl_names),
labeller = as_labeller(labels),
scales = "free") +
labs(x = "Explanatory Variables", y = "Dependent Variables")
ggsave(paste0(here, "/figs/fs1_DepVarsVsExplVars_AllSamples.png"),
width = 11, height = 8)
##4.1 Dependent vars vs Watershed Area----
dat4 %>% ggplot(mapping= aes(x= WsAreaSqKm, y= dep_values)) +
geom_jitter(width = 0.02) +
geom_smooth(method = "lm", se=TRUE) +
# scale_x_log10() +
scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = bquote("Watershed Area ("*km^2*")"), y = "Dependent Variables") +
stat_correlation(use_label(c("rr", "p")),
small.r = TRUE, small.p = TRUE)
##4.1 Dependent vars vs Watershed Area----
dat4 %>% ggplot(mapping= aes(x= WsAreaSqKm, y= dep_values)) +
geom_jitter(width = 0.02) +
geom_smooth(method = "lm", se=TRUE) +
scale_x_log10() +
scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = bquote("Watershed Area ("*km^2*")"), y = "Dependent Variables") +
stat_correlation(use_label(c("rr", "p")),
small.r = TRUE, small.p = TRUE)
ggsave(paste0(here, "/figs/f1_DepVarsVsWsArea_ByWatershed.png"),
width = 11, height = 8)
##4.2 Dependent vars vs Transit Time ----
dat4 %>% ggplot(mapping= aes(x= tt_hr, y= dep_values)) +
geom_jitter(width = 0.02) +
geom_smooth(method = "lm", se=TRUE) +
scale_x_log10() +
scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = "Water Residence Time (h)", y = "Dependent Variables") +
stat_correlation(use_label(c("rr", "p")),
small.r = TRUE, small.p = TRUE)
ggsave(paste0(here, "/figs/f2_DepVarsVsWRT_ByWatershed.png"),
width = 11, height = 8)
##4.2 Dependent vars vs Transit Time ----
dat4 %>% ggplot(mapping= aes(x= tt_hr, y= dep_values)) +
geom_jitter(width = 0.01) +
geom_smooth(method = "lm", se=TRUE) +
scale_x_log10() +
scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = "Water Residence Time (h)", y = "Dependent Variables") +
stat_correlation(use_label(c("rr", "p")),
small.r = TRUE, small.p = TRUE)
ggsave(paste0(here, "/figs/f2_DepVarsVsWRT_ByWatershed.png"),
width = 11, height = 8)
##4.3 Dependent vars vs LULC evenness, no log transform ----
dat4 %>% ggplot(mapping= aes(x= lulc_evenness, y= dep_values)) +
geom_jitter(width = 0.02) +
geom_smooth(method = "lm", se=TRUE) +
# scale_x_log10() +
scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = "LULC Evenness", y = "Dependent Variables") +
stat_correlation(use_label(c("rr", "p")),
small.r = TRUE, small.p = TRUE)
ggsave(paste0(here, "/figs/f3_DepVarsVsLulcEvenness_ByWatershed.png"),
width = 11, height = 8)
##4.3 Dependent vars vs LULC evenness, no log transform ----
dat4 %>% ggplot(mapping= aes(x= lulc_evenness, y= dep_values)) +
geom_jitter(width = 0.01) +
geom_smooth(method = "lm", se=TRUE) +
# scale_x_log10() +
scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = "LULC Evenness", y = "Dependent Variables") +
stat_correlation(use_label(c("rr", "p")),
small.r = TRUE, small.p = TRUE)
ggsave(paste0(here, "/figs/f3_DepVarsVsLulcEvenness_ByWatershed.png"),
width = 11, height = 8)
##4.4 Dependent vars vs % Coniferous ----
dat4 %>% ggplot(mapping= aes(x= PctConif2019Ws, y= dep_values)) +
geom_jitter(width = 0.02) +
geom_smooth(method = "lm", se=TRUE) +
# scale_x_log10() +
scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = "Coniferous (%)", y = "Dependent Variables") +
stat_correlation(use_label(c("rr", "p")),
small.r = TRUE, small.p = TRUE)
ggsave(paste0(here, "/figs/f4_DepVarsVsPctConif_ByWatershed.png"),
width = 11, height = 8)
dat4 %>%
filter(Watershed %in% c("Gunnison", "Connecticut")) %>%
ggplot(mapping= aes(x= PctDecid2019Ws, y= dep_values)) +
geom_jitter(width = 0.02) +
geom_smooth(method = "lm", se=TRUE) +
# scale_x_log10() +
scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = "Deciduous (%)", y = "Dependent Variables") +
stat_correlation(use_label(c("rr", "p")),
small.r = TRUE, small.p = TRUE)
ggsave(paste0(here, "/figs/f5_DepVarsVsPctDecid_ByWatershed.png"),
width = 8, height = 10)
#5.0 Supplementary Figures ----
##5.1 Box plot of dependent variables by watershed ----
dat4 %>%
ggplot() +
geom_jitter(mapping= aes(x= Watershed, y = dep_values), color = "dark grey", alpha=0.9) +
geom_boxplot(mapping= aes(x= Watershed, y = dep_values), alpha=0, size=1) +
facet_grid(rows = vars(dep_names),
labeller = as_labeller(labels), scales = "free") +
labs(x = "Watershed", y = "Dependent Variables")
##5.2 Box plot of TN by explanatory variables ----
dat2 %>%
pivot_longer(cols = all_of(expl_vars),
names_to= "expl_names", values_to = "expl_values") %>%
mutate(across(where(is.character), as.factor),
expl_names = fct_relevel(expl_names, "WsAreaSqKm", "tt_hr",
"lulc_evenness", "PctConif2019Ws", "PctDecid2019Ws"),
Watershed = fct_relevel(Watershed, "Yakima", "Deschutes",
"Willamette", "Gunnison", "Connecticut")) %>%
ggplot() +
geom_jitter(mapping= aes(x= expl_values, y = TN_mgL)) +
geom_smooth(mapping= aes(x= expl_values, y= TN_mgL),
method = "lm", se=TRUE) +
stat_cor(mapping= aes(x= expl_values, y= TN_mgL), method= "pearson",
label.x.npc = "middle", label.y.npc = "bottom",
size = 2) +
scale_x_log10() +
facet_grid(rows = vars(Watershed),
cols = vars(expl_names),
labeller = as_labeller(labels),
scales = "free") +
labs(x = "Explanatory Variables", y = "TN (mg/L)")
# stat_cor(mapping= aes(x= expl_values, y= TN_mgL), method= "pearson",
#          label.x.npc = "middle", label.y.npc = "bottom",
#          size = 2) +
scale_x_log10() +
facet_grid(rows = vars(Watershed),
cols = vars(expl_names),
labeller = as_labeller(labels),
scales = "free") +
labs(x = "Explanatory Variables", y = "TN (mg/L)")
##5.2 Box plot of TN by explanatory variables ----
dat2 %>%
pivot_longer(cols = all_of(expl_vars),
names_to= "expl_names", values_to = "expl_values") %>%
mutate(across(where(is.character), as.factor),
expl_names = fct_relevel(expl_names, "WsAreaSqKm", "tt_hr",
"lulc_evenness", "PctConif2019Ws", "PctDecid2019Ws"),
Watershed = fct_relevel(Watershed, "Yakima", "Deschutes",
"Willamette", "Gunnison", "Connecticut")) %>%
ggplot(mapping= aes(x= expl_values, y = TN_mgL)) +
geom_jitter() +
geom_smooth(method = "lm", se=TRUE) +
stat_correlation(use_label(c("rr", "p")),
small.r = TRUE, small.p = TRUE) +
# stat_cor(mapping= aes(x= expl_values, y= TN_mgL), method= "pearson",
#          label.x.npc = "middle", label.y.npc = "bottom",
#          size = 2) +
scale_x_log10() +
facet_grid(rows = vars(Watershed),
cols = vars(expl_names),
labeller = as_labeller(labels),
scales = "free") +
labs(x = "Explanatory Variables", y = "TN (mg/L)")
ggsave(paste0(here, "/figs/fs3_TNvsExplVars_ByWatershed.png"),
width = 11, height = 8)
##5.2 Box plot of TN by explanatory variables ----
dat2 %>%
pivot_longer(cols = all_of(expl_vars),
names_to= "expl_names", values_to = "expl_values") %>%
mutate(across(where(is.character), as.factor),
expl_names = fct_relevel(expl_names, "WsAreaSqKm", "tt_hr",
"lulc_evenness", "PctConif2019Ws", "PctDecid2019Ws"),
Watershed = fct_relevel(Watershed, "Yakima", "Deschutes",
"Willamette", "Gunnison", "Connecticut")) %>%
ggplot(mapping= aes(x= expl_values, y = TN_mgL)) +
geom_jitter() +
geom_smooth(method = "lm", se=TRUE) +
stat_correlation(use_label(c("rr", "p")),
small.r = TRUE, small.p = TRUE) +
scale_x_log10() +
scale_y_continuous(expand = expansion(mult = c(0, 0.1))) +
facet_grid(rows = vars(Watershed),
cols = vars(expl_names),
labeller = as_labeller(labels),
scales = "free") +
labs(x = "Explanatory Variables", y = "TN (mg/L)")
ggsave(paste0(here, "/figs/fs3_TNvsExplVars_ByWatershed.png"),
width = 11, height = 8)
##5.2 Box plot of TN by explanatory variables ----
dat2 %>%
pivot_longer(cols = all_of(expl_vars),
names_to= "expl_names", values_to = "expl_values") %>%
mutate(across(where(is.character), as.factor),
expl_names = fct_relevel(expl_names, "WsAreaSqKm", "tt_hr",
"lulc_evenness", "PctConif2019Ws", "PctDecid2019Ws"),
Watershed = fct_relevel(Watershed, "Yakima", "Deschutes",
"Willamette", "Gunnison", "Connecticut")) %>%
ggplot(mapping= aes(x= expl_values, y = TN_mgL)) +
geom_jitter() +
geom_smooth(method = "lm", se=TRUE) +
stat_correlation(use_label(c("rr", "p")),
small.r = TRUE, small.p = TRUE) +
scale_x_log10() +
scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
facet_grid(rows = vars(Watershed),
cols = vars(expl_names),
labeller = as_labeller(labels),
scales = "free") +
labs(x = "Explanatory Variables", y = "TN (mg/L)")
ggsave(paste0(here, "/figs/fs3_TNvsExplVars_ByWatershed.png"),
width = 11, height = 8)
##5.3 Box plot of Specific Discharge by explanatory variables ----
dat4 %>% ggplot(mapping= aes(x= q_daily_mm, y= dep_values)) +
geom_jitter(width = 0.02) +
geom_smooth(method = "lm", se=TRUE) +
stat_correlation(use_label(c("rr", "p")),
small.r = TRUE, small.p = TRUE) +
scale_x_log10() +
scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
labs(x = "Specific Discharge (mm)", y = "Dependent Variables")
ggsave(paste0(here, "/figs/fs4_DepVarsVsQ_ByWatershed.png"),
width = 11, height = 8)
##5.4 Box plot of dependent variables by season ----
dat4 %>%
ggplot() +
geom_jitter(mapping= aes(x= season_tb, y = dep_values), color = "dark grey", alpha=0.9) +
geom_boxplot(mapping= aes(x= season_tb, y = dep_values), alpha=0, size=1) +
facet_grid(rows = vars(dep_names),
labeller = as_labeller(labels), scales = "free") +
labs(x = "Season", y = "Dependent Variables")
