lm_mods_mean_watershed2 <- lm_mods_mean_watershed %>%
select(dep_names, expl_names, nobs, p.value, r.squared, adj.r.squared, RMSE, statistic, df, r) %>%
mutate(p = case_when(p.value < 0.1 ~ "< 0.1",
TRUE ~ "n.s.")) %>%
mutate(r.sq.adj = case_when(p != "n.s." ~
formatC(round(adj.r.squared, 2), format = 'f',
digits = 2),
TRUE ~ NA_character_),
r_labels = case_when(p != "n.s." ~ paste0("r~'= '*", r)),
r2_labels = case_when(!is.na(r.sq.adj) ~ paste0("r^2~'= '*", r.sq.adj)))
write_csv(lm_mods_mean_watershed2, paste0(here, "/figs/tables/lm_mods_mean_watershed.csv"))
View(lm_mods_mean_watershed2)
lm_log_mods_watershed2 <- lm_log_mods_watershed %>%
select(dep_names, expl_names, nobs, p.value, r.squared, adj.r.squared, RMSE, statistic, df, r) %>%
mutate(p = case_when(p.value < 0.1 ~ "< 0.1",
TRUE ~ "n.s.")) %>%
mutate(r.sq.adj = case_when(p != "n.s." ~
formatC(round(adj.r.squared, 2), format = 'f',
digits = 2),
TRUE ~ NA_character_),
r_labels = case_when(p != "n.s." ~ paste0("r~'= '*",
formatC(round(r, 2), format = 'f',
digits = 2))),
r2_labels = case_when(!is.na(r.sq.adj) ~ paste0("r^2~'= '*", r.sq.adj)))
View(lm_log_mods_watershed2)
#4.0 Correlations ----
## Pearson correlation, all variables, by watershed, explanatory vars log transformed ----
lm_log_mods_watershed <- dat3 %>%
mutate(expl_values2 = case_when(expl_names == "PctDecid2019Ws" &
expl_values == 0 ~ 0.01,
TRUE ~ expl_values),
expl_values_log = log10(expl_values2)) %>%
group_by(Watershed, expl_names, dep_names) %>%
nest() %>%
mutate(model = map(data,
.f = ~lm(dep_values ~ expl_values_log,
data = .)),
glance = map(.x = model, .f = ~broom::glance(.x)),
preds = map(model, broom::augment),
RMSE = map_dbl(preds, .f = ~sqrt(mean(.x$.resid^2))),
r = map_dbl(.x = data, .f = ~cor(.x$dep_values, .x$expl_values_log))) %>%
unnest(glance)
lm_log_mods_watershed2 <- lm_log_mods_watershed %>%
select(dep_names, expl_names, nobs, p.value, r.squared, adj.r.squared, RMSE, statistic, df, r) %>%
mutate(p = case_when(p.value < 0.1 ~ "< 0.1",
TRUE ~ "n.s.")) %>%
mutate(r.sq.adj = case_when(p != "n.s." ~
formatC(round(adj.r.squared, 2), format = 'f',
digits = 2),
TRUE ~ NA_character_),
r_labels = case_when(p != "n.s." ~ paste0("r~'= '*",
formatC(round(r, 2), format = 'f',
digits = 2))),
r2_labels = case_when(!is.na(r.sq.adj) ~ paste0("r^2~'= '*", r.sq.adj)))
write_csv(lm_log_mods_watershed2, paste0(here, "/figs/tables/lm_log_mods_watershed.csv"))
## Pearson correlation, all variables, by watershed, explanatory vars log transformed, mean dep vars ----
lm_log_mean_watershed <- dat5 %>%
mutate(expl_values2 = case_when(expl_names == "PctDecid2019Ws" &
expl_values == 0 ~ 0.01,
TRUE ~ expl_values),
expl_values_log = log10(expl_values2)) %>%
group_by(Watershed, expl_names, dep_names) %>%
nest() %>%
mutate(model = map(data,
.f = ~lm(dep_mean ~ expl_values_log,
data = .)),
glance = map(.x = model, .f = ~broom::glance(.x)),
preds = map(model, broom::augment),
r = map_dbl(.x = data, .f = ~cor(.x$dep_mean, .x$expl_values_log)),
RMSE = map_dbl(preds, .f = ~sqrt(mean(.x$.resid^2)))) %>%
unnest(glance)
lm_log_mean_watershed2 <- lm_log_mods_watershed %>%
select(dep_names, expl_names, nobs, p.value, r.squared, adj.r.squared, RMSE, statistic, df, r) %>%
mutate(p = case_when(p.value < 0.1 ~ "< 0.1",
TRUE ~ "n.s.")) %>%
mutate(r.sq.adj = case_when(p != "n.s." ~
formatC(round(adj.r.squared, 2), format = 'f',
digits = 2),
TRUE ~ NA_character_),
r_labels = case_when(p != "n.s." ~ paste0("r~'= '*",
formatC(round(r, 2), format = 'f',
digits = 2))),
r2_labels = case_when(!is.na(r.sq.adj) ~ paste0("r^2~'= '*", r.sq.adj)))
write_csv(lm_log_mean_watershed2, paste0(here, "/figs/tables/lm_log_mean_watershed.csv"))
## Pearson correlation, all variables, by watershed ----
lm_mods_watershed <- dat3 %>%
group_by(Watershed, expl_names, dep_names) %>%
nest() %>%
mutate(model = map(data,
.f = ~lm(dep_values ~ expl_values,
data = .)),
glance = map(.x = model, .f = ~broom::glance(.x)),
preds = map(model, broom::augment),
r = map_dbl(.x = data, .f = ~cor(.x$dep_values, .x$expl_values)),
RMSE = map_dbl(preds, .f = ~sqrt(mean(.x$.resid^2)))) %>%
unnest(glance)
lm_mods_watershed2 <- lm_mods_watershed %>%
select(dep_names, expl_names, nobs, p.value, r.squared, adj.r.squared, RMSE, statistic, df, r) %>%
mutate(p = case_when(p.value < 0.1 ~ "< 0.1",
TRUE ~ "n.s.")) %>%
mutate(r.sq.adj = case_when(p != "n.s." ~
formatC(round(adj.r.squared, 2), format = 'f',
digits = 2),
TRUE ~ NA_character_),
r_labels = case_when(p != "n.s." ~ paste0("r~'= '*",
formatC(round(r, 2), format = 'f',
digits = 2))),
r2_labels = case_when(!is.na(r.sq.adj) ~ paste0("r^2~'= '*", r.sq.adj)))
write_csv(lm_mods_watershed2, paste0(here, "/figs/tables/lm_mods_watershed.csv"))
## Pearson correlation, all variables, by watershed, mean dep vars ----
lm_mods_mean_watershed <- dat5 %>%
group_by(Watershed, expl_names, dep_names) %>%
nest() %>%
mutate(model = map(data,
.f = ~lm(dep_mean ~ expl_values,
data = .)),
glance = map(.x = model, .f = ~broom::glance(.x)),
preds = map(model, broom::augment),
r = map_dbl(.x = data, .f = ~cor(.x$dep_mean, .x$expl_values)),
RMSE = map_dbl(preds, .f = ~sqrt(mean(.x$.resid^2)))) %>%
unnest(glance)
lm_mods_mean_watershed2 <- lm_mods_mean_watershed %>%
select(dep_names, expl_names, nobs, p.value, r.squared, adj.r.squared, RMSE, statistic, df, r) %>%
mutate(p = case_when(p.value < 0.1 ~ "< 0.1",
TRUE ~ "n.s.")) %>%
mutate(r.sq.adj = case_when(p != "n.s." ~
formatC(round(adj.r.squared, 2), format = 'f',
digits = 2),
TRUE ~ NA_character_),
r_labels = case_when(p != "n.s." ~ paste0("r~'= '*",
formatC(round(r, 2), format = 'f',
digits = 2))),
r2_labels = case_when(!is.na(r.sq.adj) ~ paste0("r^2~'= '*", r.sq.adj)))
write_csv(lm_mods_mean_watershed2, paste0(here, "/figs/tables/lm_mods_mean_watershed.csv"))
#5.0 Plots----
##5.1 Mean dependent vars vs Watershed Area----
#plotting averaged data by site
stats <- lm_log_mean_watershed2 %>%
filter(expl_names == "WsAreaSqKm")
label_coord <- dat5 %>%
group_by(dep_names, expl_names) %>%
mutate(x_pos = max(expl_values, na.rm = T)*0.01,
y_pos = max(dep_mean, na.rm = T)*1.2) %>%
ungroup() %>%
distinct(Watershed, dep_names, expl_names, .keep_all = TRUE) %>%
filter(expl_names == "WsAreaSqKm") %>%
select(Watershed, dep_names, x_pos, y_pos)
stats <- stats %>%
left_join(., label_coord, by = c("Watershed", "dep_names"))
dat5 %>%
pivot_wider(names_from = expl_names, values_from = expl_values) %>%
ggplot() +
geom_jitter(data = dat4, mapping= aes(x= WsAreaSqKm, y = dep_values),
width = 0.02, shape = 1) +
geom_point(mapping= aes(x= WsAreaSqKm, y = dep_mean)) +
geom_errorbar(mapping= aes(x= WsAreaSqKm, ymin = dep_mean-dep_sd, ymax= dep_mean+dep_sd)) +
geom_smooth(mapping= aes(x= WsAreaSqKm, y = dep_mean), method = "lm", se=TRUE) +
scale_x_log10(limits = c(10, 10000),
breaks = c(1, 10, 100, 1000, 10000),
labels = scales::trans_format("log10", scales::math_format(10^.x))) +
scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
labs(x = bquote("Watershed Area ("*km^2*")"), y = "Dependent Variables") +
geom_text(data = stats,
mapping = aes(x = x_pos, y = y_pos, label = r_labels),
parse = TRUE,
size = 4) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
theme(axis.text.x = element_text(size= 9))
View(lm_log_mean_watershed2)
## Pearson correlation, all variables, by watershed, explanatory vars log transformed, mean dep vars ----
lm_log_mean_watershed <- dat5 %>%
mutate(expl_values2 = case_when(expl_names == "PctDecid2019Ws" &
expl_values == 0 ~ 0.01,
TRUE ~ expl_values),
expl_values_log = log10(expl_values2)) %>%
group_by(Watershed, expl_names, dep_names) %>%
nest() %>%
mutate(model = map(data,
.f = ~lm(dep_mean ~ expl_values_log,
data = .)),
glance = map(.x = model, .f = ~broom::glance(.x)),
preds = map(model, broom::augment),
r = map_dbl(.x = data, .f = ~cor(.x$dep_mean, .x$expl_values_log, use = "p")),
RMSE = map_dbl(preds, .f = ~sqrt(mean(.x$.resid^2)))) %>%
unnest(glance)
lm_log_mean_watershed2 <- lm_log_mods_watershed %>%
select(dep_names, expl_names, nobs, p.value, r.squared, adj.r.squared, RMSE, statistic, df, r) %>%
mutate(p = case_when(p.value < 0.1 ~ "< 0.1",
TRUE ~ "n.s.")) %>%
mutate(r.sq.adj = case_when(p != "n.s." ~
formatC(round(adj.r.squared, 2), format = 'f',
digits = 2),
TRUE ~ NA_character_),
r_labels = case_when(p != "n.s." ~ paste0("r~'= '*",
formatC(round(r, 2), format = 'f',
digits = 2))),
r2_labels = case_when(!is.na(r.sq.adj) ~ paste0("r^2~'= '*", r.sq.adj)))
write_csv(lm_log_mean_watershed2, paste0(here, "/figs/tables/lm_log_mean_watershed.csv"))
## Pearson correlation, all variables, by watershed, explanatory vars log transformed, mean dep vars ----
lm_log_mean_watershed <- dat5 %>%
mutate(expl_values2 = case_when(expl_names == "PctDecid2019Ws" &
expl_values == 0 ~ 0.01,
TRUE ~ expl_values),
expl_values_log = log10(expl_values2)) %>%
group_by(Watershed, expl_names, dep_names) %>%
nest() %>%
mutate(model = map(data,
.f = ~lm(dep_mean ~ expl_values_log,
data = .)),
glance = map(.x = model, .f = ~broom::glance(.x)),
preds = map(model, broom::augment),
r = map_dbl(.x = data, .f = ~cor(.x$dep_mean, .x$expl_values_log, use = "p")),
RMSE = map_dbl(preds, .f = ~sqrt(mean(.x$.resid^2)))) %>%
unnest(glance)
lm_log_mean_watershed2 <- lm_log_mods_watershed %>%
select(dep_names, expl_names, nobs, p.value, r.squared, adj.r.squared, RMSE, statistic, df, r) %>%
mutate(p = case_when(p.value < 0.1 ~ "< 0.1",
TRUE ~ "n.s.")) %>%
mutate(r.sq.adj = case_when(p != "n.s." ~
formatC(round(adj.r.squared, 2), format = 'f',
digits = 2),
TRUE ~ NA_character_),
r_labels = case_when(p != "n.s." ~ paste0("r~'= '*",
formatC(round(r, 2), format = 'f',
digits = 2))),
r2_labels = case_when(!is.na(r.sq.adj) ~ paste0("r^2~'= '*", r.sq.adj)))
write_csv(lm_log_mean_watershed2, paste0(here, "/figs/tables/lm_log_mean_watershed.csv"))
View(lm_log_mean_watershed2)
## Pearson correlation, all variables, by watershed, explanatory vars log transformed, mean dep vars ----
lm_log_mean_watershed <- dat5 %>%
mutate(expl_values2 = case_when(expl_names == "PctDecid2019Ws" &
expl_values == 0 ~ 0.01,
TRUE ~ expl_values),
expl_values_log = log10(expl_values2)) %>%
group_by(Watershed, expl_names, dep_names) %>%
nest() %>%
mutate(model = map(data,
.f = ~lm(dep_mean ~ expl_values_log,
data = .)),
glance = map(.x = model, .f = ~broom::glance(.x)),
preds = map(model, broom::augment),
r = map_dbl(.x = data, .f = ~cor(.x$dep_mean, .x$expl_values_log, use = "e")),
RMSE = map_dbl(preds, .f = ~sqrt(mean(.x$.resid^2)))) %>%
unnest(glance)
lm_log_mean_watershed2 <- lm_log_mods_watershed %>%
select(dep_names, expl_names, nobs, p.value, r.squared, adj.r.squared, RMSE, statistic, df, r) %>%
mutate(p = case_when(p.value < 0.1 ~ "< 0.1",
TRUE ~ "n.s.")) %>%
mutate(r.sq.adj = case_when(p != "n.s." ~
formatC(round(adj.r.squared, 2), format = 'f',
digits = 2),
TRUE ~ NA_character_),
r_labels = case_when(p != "n.s." ~ paste0("r~'= '*",
formatC(round(r, 2), format = 'f',
digits = 2))),
r2_labels = case_when(!is.na(r.sq.adj) ~ paste0("r^2~'= '*", r.sq.adj)))
View(lm_log_mean_watershed2)
#5.0 Plots----
##5.1 Mean dependent vars vs Watershed Area----
#plotting averaged data by site
stats <- lm_log_mean_watershed2 %>%
filter(expl_names == "WsAreaSqKm")
label_coord <- dat5 %>%
group_by(dep_names, expl_names) %>%
mutate(x_pos = max(expl_values, na.rm = T)*0.01,
y_pos = max(dep_mean, na.rm = T)*1.2) %>%
ungroup() %>%
distinct(Watershed, dep_names, expl_names, .keep_all = TRUE) %>%
filter(expl_names == "WsAreaSqKm") %>%
select(Watershed, dep_names, x_pos, y_pos)
stats <- stats %>%
left_join(., label_coord, by = c("Watershed", "dep_names"))
dat5 %>%
pivot_wider(names_from = expl_names, values_from = expl_values) %>%
ggplot() +
geom_jitter(data = dat4, mapping= aes(x= WsAreaSqKm, y = dep_values),
width = 0.02, shape = 1) +
geom_point(mapping= aes(x= WsAreaSqKm, y = dep_mean)) +
geom_errorbar(mapping= aes(x= WsAreaSqKm, ymin = dep_mean-dep_sd, ymax= dep_mean+dep_sd)) +
geom_smooth(mapping= aes(x= WsAreaSqKm, y = dep_mean), method = "lm", se=TRUE) +
scale_x_log10(limits = c(10, 10000),
breaks = c(1, 10, 100, 1000, 10000),
labels = scales::trans_format("log10", scales::math_format(10^.x))) +
scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
labs(x = bquote("Watershed Area ("*km^2*")"), y = "Dependent Variables") +
geom_text(data = stats,
mapping = aes(x = x_pos, y = y_pos, label = r_labels),
parse = TRUE,
size = 4) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
theme(axis.text.x = element_text(size= 9))
ggsave(paste0(here, "/figs/f1_DepVarsVsWsArea_mean.png"),
width = 8, height = 6)
##5.2 Dependent vars vs Watershed Area ----
stats <- lm_log_mods_watershed2 %>%
filter(expl_names == "WsAreaSqKm")
label_coord <- dat3 %>%
group_by(dep_names, expl_names) %>%
mutate(x_pos = max(expl_values, na.rm = T)*0.05,
y_pos = max(dep_values, na.rm = T)*1.2) %>%
ungroup() %>%
distinct(Watershed, dep_names, expl_names, .keep_all = TRUE) %>%
filter(expl_names == "WsAreaSqKm") %>%
select(Watershed, dep_names, x_pos, y_pos)
stats <- stats %>%
left_join(., label_coord, by = c("Watershed", "dep_names"))
dat4 %>% ggplot(mapping= aes(x= WsAreaSqKm, y= dep_values)) +
geom_jitter(width = 0.02) +
geom_smooth(method = "lm", se=TRUE) +
scale_x_log10(limits = c(10, 10000),
breaks = c(1, 10, 100, 1000, 10000),
labels = scales::trans_format("log10", scales::math_format(10^.x))) +
scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
labs(x = bquote("Watershed Area ("*km^2*")"), y = "Dependent Variables") +
geom_text(data = stats,
mapping = aes(x = x_pos, y = y_pos, label = r_labels),
parse = TRUE,
size = 4) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
theme(axis.text.x = element_text(size= 9))
ggsave(paste0(here, "/figs/f1_DepVarsVsWsArea.png"),
width = 8, height = 6)
##5.3 Mean Dependent variable vs Water Residence Time----
stats <- lm_log_mean_watershed2 %>%
filter(expl_names == "tt_hr")
label_coord <- dat5 %>%
group_by(dep_names, expl_names) %>%
mutate(x_pos = max(expl_values, na.rm = T)*0.01,
y_pos = max(dep_mean, na.rm = T)*1.2) %>%
ungroup() %>%
distinct(Watershed, dep_names, expl_names, .keep_all = TRUE) %>%
filter(expl_names == "tt_hr") %>%
select(Watershed, dep_names, x_pos, y_pos)
stats <- stats %>%
left_join(., label_coord, by = c("Watershed", "dep_names"))
dat5 %>%
pivot_wider(names_from = expl_names, values_from = expl_values) %>%
ggplot() +
geom_jitter(data = dat4, mapping= aes(x= tt_hr, y = dep_values),
width = 0.02, shape = 1) +
geom_point(mapping= aes(x= tt_hr, y = dep_mean)) +
geom_errorbar(mapping= aes(x= tt_hr, ymin = dep_mean-dep_sd, ymax= dep_mean+dep_sd)) +
geom_smooth(mapping= aes(x= tt_hr, y = dep_mean), method = "lm", se=TRUE) +
scale_x_log10(limits = c(10, 10000),
breaks = c(1, 10, 100, 1000, 10000),
labels = scales::trans_format("log10", scales::math_format(10^.x))) +
scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
labs(x = "Water Residence Time (h)", y = "Dependent Variables") +
geom_text(data = stats,
mapping = aes(x = x_pos, y = y_pos, label = r_labels),
parse = TRUE,
size = 4) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
theme(axis.text.x = element_text(size= 9))
ggsave(paste0(here, "/figs/f2_DepVarsVsWRT_mean.png"),
width = 8, height = 6)
##5.4 Dependent variable vs Water Residence Time ----
stats <- lm_log_mods_watershed2 %>%
filter(expl_names == "tt_hr")
label_coord <- dat3 %>%
group_by(dep_names, expl_names) %>%
mutate(x_pos = max(expl_values, na.rm = T)*0.05,
y_pos = max(dep_values, na.rm = T)*1.2) %>%
ungroup() %>%
distinct(Watershed, dep_names, expl_names, .keep_all = TRUE) %>%
filter(expl_names == "tt_hr") %>%
select(Watershed, dep_names, x_pos, y_pos)
stats <- stats %>%
left_join(., label_coord, by = c("Watershed", "dep_names"))
dat4 %>% ggplot(mapping= aes(x= tt_hr, y= dep_values)) +
geom_jitter(width = 0.02) +
geom_smooth(method = "lm", se=TRUE) +
scale_x_log10(limits = c(10, 10000),
breaks = c(1, 10, 100, 1000, 10000),
labels = scales::trans_format("log10", scales::math_format(10^.x))) +
scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
labs(x = "Water Residence Time (h)", y = "Dependent Variables") +
geom_text(data = stats,
mapping = aes(x = x_pos, y = y_pos, label = r_labels),
parse = TRUE,
size = 4) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
theme(axis.text.x = element_text(size= 9))
ggsave(paste0(here, "/figs/f2_DepVarsVsWRT.png"),
width = 8, height = 6)
##5.5 Dependent vars vs LULC evenness, no log transform ----
stats <- lm_mods_watershed2 %>%
filter(expl_names == "lulc_evenness")
label_coord <- dat3 %>%
group_by(dep_names, expl_names) %>%
mutate(x_pos = 0.25,#max(expl_values, na.rm = T)*0.9,
y_pos = max(dep_values, na.rm = T)*1.2) %>%
ungroup() %>%
distinct(Watershed, dep_names, expl_names, .keep_all = TRUE) %>%
filter(expl_names == "lulc_evenness") %>%
select(Watershed, dep_names, x_pos, y_pos)
stats <- stats %>%
left_join(., label_coord, by = c("Watershed", "dep_names"))
dat4 %>% ggplot(mapping= aes(x= lulc_evenness, y= dep_values)) +
geom_jitter(width = 0.02) +
geom_smooth(method = "lm", se=TRUE) +
scale_x_continuous(limits = c(0,0.7)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
labs(x = "LULC Evenness", y = "Dependent Variables") +
geom_text(data = stats,
mapping = aes(x = x_pos, y = y_pos, label = r_labels),
parse = TRUE,
size = 4) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
theme(axis.text.x = element_text(size= 9))
ggsave(paste0(here, "/figs/f3_DepVarsVsLulcEvenness.png"),
width = 8, height = 6)
##5.6  Mean dependent vars vs LULC evenness, no log transform ----
stats <- lm_mods_mean_watershed2 %>%
filter(expl_names == "lulc_evenness")
label_coord <- dat5 %>%
group_by(dep_names, expl_names) %>%
mutate(x_pos = 0.25,# max(expl_values, na.rm = T)*0.01,
y_pos = max(dep_mean, na.rm = T)*1.2) %>%
ungroup() %>%
distinct(Watershed, dep_names, expl_names, .keep_all = TRUE) %>%
filter(expl_names == "lulc_evenness") %>%
select(Watershed, dep_names, x_pos, y_pos)
stats <- stats %>%
left_join(., label_coord, by = c("Watershed", "dep_names"))
dat5 %>%
pivot_wider(names_from = expl_names, values_from = expl_values) %>%
ggplot() +
geom_jitter(data = dat4, mapping= aes(x= lulc_evenness, y = dep_values),
width = 0.02, shape = 1) +
geom_point(mapping= aes(x= lulc_evenness, y = dep_mean)) +
geom_errorbar(mapping= aes(x= lulc_evenness, ymin = dep_mean-dep_sd, ymax= dep_mean+dep_sd)) +
geom_smooth(mapping= aes(x= lulc_evenness, y = dep_mean), method = "lm", se=TRUE) +
scale_x_continuous(limits = c(0, 0.7)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
labs(x = "LULC Evenness", y = "Dependent Variables") +
geom_text(data = stats,
mapping = aes(x = x_pos, y = y_pos, label = r_labels),
parse = TRUE,
size = 4) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
theme(axis.text.x = element_text(size= 9))
ggsave(paste0(here, "/figs/f3_DepVarsVsLulcEvenness_mean.png"),
width = 8, height = 6)
##5.7 Dependent vars vs coniferous, no log transform ----
stats <- lm_mods_watershed2 %>%
filter(expl_names == "PctConif2019Ws")
label_coord <- dat3 %>%
group_by(dep_names, expl_names) %>%
mutate(x_pos = 50, #max(expl_values, na.rm = T)*0.5,
y_pos = max(dep_values, na.rm = T)*1.2) %>%
ungroup() %>%
distinct(Watershed, dep_names, expl_names, .keep_all = TRUE) %>%
filter(expl_names == "PctConif2019Ws") %>%
select(Watershed, dep_names, x_pos, y_pos)
stats <- stats %>%
left_join(., label_coord, by = c("Watershed", "dep_names"))
dat4 %>% ggplot(mapping= aes(x= PctConif2019Ws, y= dep_values)) +
geom_jitter(width = 0.02) +
geom_smooth(method = "lm", se=TRUE) +
scale_x_continuous(limits = c(0,100)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
labs(x = "Coniferous (%)", y = "Dependent Variables") +
geom_text(data = stats,
mapping = aes(x = x_pos, y = y_pos, label = r_labels),
parse = TRUE,
size = 4) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
theme(axis.text.x = element_text(size= 9))
ggsave(paste0(here, "/figs/f4_DepVarsVsPctConif.png"),
width = 8, height = 6)
##5.8  Mean dependent vars vs LULC evenness, no log transform ----
stats <- lm_mods_mean_watershed2 %>%
filter(expl_names == "PctConif2019Ws")
label_coord <- dat5 %>%
group_by(dep_names, expl_names) %>%
mutate(x_pos = 50,# max(expl_values, na.rm = T)*0.01,
y_pos = max(dep_mean, na.rm = T)*1.2) %>%
ungroup() %>%
distinct(Watershed, dep_names, expl_names, .keep_all = TRUE) %>%
filter(expl_names == "PctConif2019Ws") %>%
select(Watershed, dep_names, x_pos, y_pos)
stats <- stats %>%
left_join(., label_coord, by = c("Watershed", "dep_names"))
dat5 %>%
pivot_wider(names_from = expl_names, values_from = expl_values) %>%
ggplot() +
geom_jitter(data = dat4, mapping= aes(x= PctConif2019Ws, y = dep_values),
width = 0.02, shape = 1) +
geom_point(mapping= aes(x= PctConif2019Ws, y = dep_mean)) +
geom_errorbar(mapping= aes(x= PctConif2019Ws, ymin = dep_mean-dep_sd, ymax= dep_mean+dep_sd)) +
geom_smooth(mapping= aes(x= PctConif2019Ws, y = dep_mean), method = "lm", se=TRUE) +
scale_x_continuous(limits = c(0, 100)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
labs(x = "Coniferous (%)", y = "Dependent Variables") +
geom_text(data = stats,
mapping = aes(x = x_pos, y = y_pos, label = r_labels),
parse = TRUE,
size = 4) +
facet_grid(rows = vars(dep_names), cols = vars(Watershed),
labeller = as_labeller(labels), scales = "free") +
theme(axis.text.x = element_text(size= 9))
ggsave(paste0(here, "/figs/f4_DepVarsVsPctConif_mean.png"),
width = 8, height = 6)
